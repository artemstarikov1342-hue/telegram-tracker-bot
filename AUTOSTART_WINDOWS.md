# Автозапуск бота на Windows

Инструкция по настройке автоматического запуска бота при загрузке Windows.

## Способ 1: Планировщик заданий (рекомендуется)

### Шаг 1: Создайте скрипт запуска

Уже создан файл `start_bot.bat` в папке проекта.

### Шаг 2: Откройте Планировщик заданий

1. Нажмите `Win + R`
2. Введите `taskschd.msc`
3. Нажмите Enter

### Шаг 3: Создайте новую задачу

1. В правой панели нажмите **"Создать задачу..."**
2. На вкладке **"Общие"**:
   - Имя: `Telegram Tracker Bot`
   - Описание: `Автозапуск бота для интеграции с Яндекс.Трекером`
   - ✅ Выполнить с наивысшими правами
   - Настроить для: Windows 10/11

3. На вкладке **"Триггеры"**:
   - Нажмите **"Создать..."**
   - Начать задачу: **При запуске**
   - ✅ Включено
   - Нажмите **"ОК"**

4. На вкладке **"Действия"**:
   - Нажмите **"Создать..."**
   - Действие: **Запуск программы**
   - Программа или сценарий: `python`
   - Добавить аргументы: `bot.py`
   - Рабочая папка: `C:\Users\79967\OneDrive\Рабочий стол\CURSOR\telegram_tracker_bot`
     (замените на полный путь к вашей папке!)
   - Нажмите **"ОК"**

5. На вкладке **"Условия"**:
   - ❌ Запускать задачу только при питании от электросети
   - ✅ Пробуждать компьютер для выполнения задачи (опционально)

6. На вкладке **"Параметры"**:
   - ✅ Выполнять задачу при пропуске запланированного запуска
   - ✅ При сбое перезапускать через: 1 минута
   - Повторить попытку: 3 раза

7. Нажмите **"ОК"**

### Шаг 4: Проверьте задачу

1. Найдите созданную задачу в списке
2. Щелкните правой кнопкой → **"Выполнить"**
3. Проверьте, что бот запустился (откройте Telegram и отправьте `/start`)

## Способ 2: Автозагрузка через папку

⚠️ **Внимание:** Этот способ менее надежен, т.к. окно консоли будет открываться при запуске.

### Шаг 1: Создайте ярлык

1. Щелкните правой кнопкой на `start_bot.bat`
2. Выберите **"Создать ярлык"**

### Шаг 2: Переместите в автозагрузку

1. Нажмите `Win + R`
2. Введите `shell:startup`
3. Нажмите Enter
4. Переместите созданный ярлык в открывшуюся папку

### Шаг 3: Перезагрузите компьютер

Бот автоматически запустится при следующей загрузке Windows.

## Способ 3: Фоновый запуск с pythonw

Для запуска без окна консоли:

### Шаг 1: Создайте файл `start_bot_hidden.vbs`

```vbscript
Set WshShell = CreateObject("WScript.Shell")
WshShell.Run "python bot.py", 0, False
Set WshShell = Nothing
```

### Шаг 2: Настройте автозапуск

Используйте этот VBS файл вместо BAT в Планировщике заданий или в папке автозагрузки.

## Проверка работы

### Просмотр логов

Откройте файл `bot.log` в папке проекта для просмотра событий.

### Проверка через Диспетчер задач

1. Откройте Диспетчер задач (Ctrl + Shift + Esc)
2. Вкладка **"Подробности"**
3. Найдите процесс `python.exe`
4. Если есть - бот работает

### Тест через Telegram

1. Откройте чат с ботом
2. Отправьте `/start`
3. Если бот отвечает - все работает!

## Остановка бота

### Временная остановка

**Способ 1: Через Диспетчер задач**
1. Ctrl + Shift + Esc
2. Найдите процесс `python.exe` (bot.py)
3. Щелкните правой кнопкой → Завершить задачу

**Способ 2: Через Планировщик**
1. Откройте Планировщик заданий
2. Найдите задачу "Telegram Tracker Bot"
3. Щелкните правой кнопкой → Остановить

### Отключение автозапуска

**В Планировщике заданий:**
1. Найдите задачу
2. Щелкните правой кнопкой → Отключить

**В автозагрузке:**
1. `Win + R` → `shell:startup`
2. Удалите ярлык бота

## Обновление бота

1. Остановите бот (см. выше)
2. Обновите файлы проекта
3. Запустите бот снова или перезагрузите компьютер

## Устранение проблем

### Бот не запускается

1. Проверьте, что Python установлен:
```bash
python --version
```

2. Проверьте зависимости:
```bash
pip install -r requirements.txt
```

3. Проверьте `.env` файл (токены должны быть правильными)

4. Запустите вручную и проверьте ошибки:
```bash
python bot.py
```

### Бот останавливается после запуска

1. Проверьте логи в `bot.log`
2. Убедитесь, что токены правильные
3. Проверьте подключение к интернету

### Несколько экземпляров бота

1. Откройте Диспетчер задач
2. Завершите все процессы `python.exe` связанные с ботом
3. Запустите только один экземпляр

## Мониторинг бота

### Создание уведомления при падении

Добавьте в Планировщик заданий:

1. Вкладка **"Действия"** → Создать дополнительное действие
2. Действие: Отправить сообщение (в новых версиях Windows недоступно)
3. Альтернатива: используйте стороннее ПО для мониторинга процессов

### Рекомендация

Для production лучше использовать:
- VPS сервер с systemd (Linux)
- Docker контейнер
- Облачные платформы (Heroku, Railway, Render)

Они обеспечивают:
- ✅ Автоматический перезапуск при сбое
- ✅ Работу 24/7 без необходимости держать ПК включенным
- ✅ Мониторинг и логи
- ✅ Простое обновление

См. раздел "Варианты хостинга" в README.md
